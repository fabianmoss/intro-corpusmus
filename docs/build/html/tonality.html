<!DOCTYPE html>
<html >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
      <title>10. A Data-Driven History of Tonality</title>
    
      <link rel="stylesheet" href="_static/pygments.css">
      <link rel="stylesheet" href="_static/theme.css">
      <link rel="stylesheet" href="_static/sphinx_press_theme.css">
      
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

      
      <script src="_static/theme-vendors.js"></script>
      <script src="_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="genindex.html" />
  <link rel="search" title="Search" href="search.html" />
  <link rel="next" title="11. Malian Percussion Music" href="mali_percussion.html" />
  <link rel="prev" title="9. Harmony and Form in Brazilian Choro" href="choro.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="index.html" class="home-link">
    
      <span class="site-name">Introduction to Musical Corpus Studies</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="index.html#introduction-to-musical-corpus-studies">Content</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 "><a href="1_orga.html" class="reference internal ">Organization</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="2_introduction.html" class="reference internal ">Introduction</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="3_folk_songs.html" class="reference internal ">Folk Songs and the Melodic Arc</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="4_jazz_solos.html" class="reference internal ">Solos in the Weimar Jazz Database</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="renaissance.html" class="reference internal ">Renaissance Chansons and Masses</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="beethoven_harmony.html" class="reference internal ">Harmony in Beethoven’s String Quartets</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="billboard.html" class="reference internal ">Harmonic Clusters in Pop Charts</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="data-driven_music_history.html" class="reference internal ">Data-Driven Music History</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="choro.html" class="reference internal ">Harmony and Form in Brazilian Choro</a>

            
          </li>

        
          <li class="toctree-l1 current"><a href="#" class="reference internal current">A Data-Driven History of Tonality</a>

            
              <ul>
                
                  <li class="toctree-l2"><a href="#musical-pieces-as-tonal-pitch-class-distributions" class="reference internal">Musical Pieces as Tonal Pitch-Class Distributions</a></li>
                
                  <li class="toctree-l2"><a href="#historical-development" class="reference internal">Historical Development</a></li>
                
              </ul>
            
          </li>

        
          <li class="toctree-l1 "><a href="mali_percussion.html" class="reference internal ">Malian Percussion Music</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="electronic.html" class="reference internal ">Electronic Music 1950–1990</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="conclusion.html" class="reference internal ">Conclusion</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="python_basics.html" class="reference internal ">Python Basics</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="bibliography.html" class="reference internal ">Bibliography</a>

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
    
    <li><span class="section-number">10. </span>A Data-Driven History of Tonality</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="choro.html"
       title="previous chapter">← <span class="section-number">9. </span>Harmony and Form in Brazilian Choro</a>
  </li>
  <li class="next">
    <a href="mali_percussion.html"
       title="next chapter"><span class="section-number">11. </span>Malian Percussion Music →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main">
            
  <div class="section" id="a-data-driven-history-of-tonality">
<h1><span class="section-number">10. </span>A Data-Driven History of Tonality<a class="headerlink" href="#a-data-driven-history-of-tonality" title="Permalink to this headline">¶</a></h1>
<a class="reference internal image-reference" href="_images/score.jpg"><img alt="Photo by `Marius Masalar &lt;https://unsplash.com/&#64;marius?utm_source=unsplash&amp;amp;utm_medium=referral&amp;amp;utm_content=creditCopyText&gt;`_ on `Unsplash &lt;https://unsplash.com/s/photos/scores?utm_source=unsplash&amp;amp;utm_medium=referral&amp;amp;utm_content=creditCopyText&gt;`_." class="align-center" src="_images/score.jpg" style="width: 100%;" /></a>
<div class="section" id="musical-pieces-as-tonal-pitch-class-distributions">
<h2><span class="section-number">10.1. </span>Musical Pieces as Tonal Pitch-Class Distributions<a class="headerlink" href="#musical-pieces-as-tonal-pitch-class-distributions" title="Permalink to this headline">¶</a></h2>
<p>Musical pieces are composed of notes which have a certain pitch, a certain duration, and are
located in a specific position in a piece. Here, we disregard both the location and the duration
of notes and consider only the pitch dimension of musical notes when counting them. It is
moreover common to consider notes to be equivalent if their respective pitches are related by
one or multiple octaves, and thus to speak of <em>pitch classes</em>. Pitch classes come in two varieties.
The first, most commonly used representation in computational musicology and music
information retrieval, distinguishes twelve different pitch classes. This representation system
also assumes the enharmonic equivalence of certain notes, e.g. <span class="math notranslate nohighlight">\(\text{F}\sharp\)</span>
and <span class="math notranslate nohighlight">\(\text{G}\flat\)</span>, <span class="math notranslate nohighlight">\(\text{C}\flat\)</span> and B, etc. The
assumption of enharmonic equivalence is usually a consequence of music encoding formats
that assume twelve-tone equal temperament, e.g. MIDI, in which enharmonically equivalent
notes are indistinguishable. The assumptions of octave and enharmonic equivalence allow to
represent pitch classes as residuals in <span class="math notranslate nohighlight">\(\mathbb{Z}_{12}\)</span> and to arrange them on a circle.
This arrangement of pitch classes is shown in <a class="reference internal" href="#circle-of-fifths"><span class="std std-numref">Fig. 10.1</span></a>, called the <em>circle of fifths</em>.</p>
<div class="figure align-center" id="id16">
<span id="circle-of-fifths"></span><a class="reference internal image-reference" href="_images/circle_of_fifths.png"><img alt="_images/circle_of_fifths.png" src="_images/circle_of_fifths.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 10.1 </span><span class="caption-text">Schematic depiction of the twelve neutral pitch-classes in <span class="math notranslate nohighlight">\(\mathbb{Z}_{12}\)</span> on the circle of fifths. One
representative of each neutral pitch-class is shown as a tonal pitch-class label next to the
node. The coloring of the nodes corresponds to the colors of the keys on the piano.</span><a class="headerlink" href="#id16" title="Permalink to this image">¶</a></p>
</div>
<p>The numbers correspond to pitch classes in the order of fifths that can be transformed to chromatic ordering, the
chromatic circle, by the mapping <span class="math notranslate nohighlight">\(t \mapsto 7 t \mod 12\)</span>. Pitch classes that correspond to white
keys on the piano are shown in white and pitch classes that correspond to black keys on the
piano are shown in black. The second variant of pitch classes does not assume enharmonic
equivalence but only that octave-related notes are equivalent, and is hence more general.
This representation allows to arrange pitch classes on the <em>line of fifths</em> <span class="bibtex" id="id1">[Temperley2000]</span>.
This linear of ordering tonal pitch-classes has been used by a number of music theorists, e.g.
<span class="bibtex" id="id2">[Weber1851]</span><span class="bibtex" id="id3">[Riemann1900]</span><span class="bibtex" id="id4">[Handschin1948]</span><span class="bibtex" id="id5">[Bardos1956]</span>. It is shown in <a class="reference internal" href="#line-of-fifths"><span class="std std-numref">Fig. 10.2</span></a>.</p>
<div class="figure align-center" id="id17">
<span id="line-of-fifths"></span><a class="reference internal image-reference" href="_images/line_of_fifths.png"><img alt="_images/line_of_fifths.png" src="_images/line_of_fifths.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 10.2 </span><span class="caption-text">Schematic depiction of the tonal pitch-classes on the line of fifths mapped to integers in <span class="math notranslate nohighlight">\(\mathbb{Z}\)</span>.</span><a class="headerlink" href="#id17" title="Permalink to this image">¶</a></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Think of other possible equivalence relations for pitch classes.
E.g. which relation do we need to distinguish only two classes, high and low with respect to middle C?</p>
</div>
<p>Following <span class="bibtex" id="id6">[Temperley2000]</span>, we call the first representation <em>neutral pitch-classes</em> and the
second one <em>tonal pitch-classes</em>. The linear structure of the line of fifths allows to associate each
tonal pitch-class with an integer <span class="math notranslate nohighlight">\(k \in \mathbb{Z}\)</span> such that this integer represents the number of perfect
fifths that lie between this pitch-class and C (Gárdonyi and Nordhoff, 2002). In other words,
the integer <span class="math notranslate nohighlight">\(k \in \mathbb{Z}\)</span> corresponds to the number of flats (negative integers) or sharps (positive
integers) that the major key has in which this tonal pitch-class is the root. For example,
D is mapped to +2 because D major has a key signature with two sharps, <span class="math notranslate nohighlight">\(\text{A}\flat\)</span> is mapped
to <span class="math notranslate nohighlight">\(-4\)</span> because the key signature for <span class="math notranslate nohighlight">\(\text{A}\flat\)</span> major has four flats, and C is mapped to 0 because
its key signature does not have any accidentals. Yet another benefit of this representation
can be seen in the way in which we associate each tonal pitch-class with a color. Positive
integers (‘sharpened’ tonal pitch-classes) are associated with increasingly darker shades of
red, negative integers are associated with increasingly darker shades of blue (‘flattened’ tonal
pitch-classes), and C is associated with white as the neutral origin of the line of fifths. This
color mapping is used throughout this part. The line of fifths does not only contain all tonal
pitch-classes but also a number of central musical scales. For example, pentatonic scales are
segments of length 4 (containing five pitch classes) on the line of fifths, e.g. from <span class="math notranslate nohighlight">\(\text{G}\flat\)</span> to <span class="math notranslate nohighlight">\(\text{B}\flat\)</span>,
diatonic scales are defined by segments of lenght 6, e.g. from F to B, the early extensions of
the natural diatonic scale by <span class="math notranslate nohighlight">\(\text{B}\flat\)</span> and <span class="math notranslate nohighlight">\(\text{F}\sharp\)</span>
correspond to the segment spanning the eight fifths on
the line between these two tonal pitch-classes, and the two whole-tone scales correspond to
the odd and even numbers, respectively. Theoretically, the line of fifths extends to infinity in
both directions but in actual compositions only a small segment of it is used. In the corpus
that is used here, we consider only the segment from <span class="math notranslate nohighlight">\(\text{F}\flat\flat\)</span> to <span class="math notranslate nohighlight">\(\text{B}\sharp\sharp\)</span>
because no piece in the corpus
contains tonal pitch-classes outside this range. The vocabulary size of the corpus is thus
<span class="math notranslate nohighlight">\(V = 35\)</span>, consisting of the seven natural pitch-classes F, C, G, D, A, E, B with two, one, or zero
sharps or flats, respectively. While the transformation of tonal into neutral pitch-classes is
achieved by deterministically mapping a tonal pitch-class <span class="math notranslate nohighlight">\(t \in \mathbb{Z}\)</span> to a neutral pitch-class
<span class="math notranslate nohighlight">\(t \mapsto t \mod 12 \in \mathbb{Z}_{12}\)</span> (in fifths ordering), the reverse direction involves some kind of inference and is
called the problem of pitch spelling (<span class="bibtex" id="id7">[Temperley2001]</span><span class="bibtex" id="id8">[Cambouropoulos2003]</span><span class="bibtex" id="id9">[Stoddard2004]</span><span class="bibtex" id="id10">[Chew2005]</span><span class="bibtex" id="id11">[Meredith2006]</span>).</p>
<p>helix</p>
<p>Due to the encoding of the corpus, we adopt the
representation of pieces as bags of notes (see Section~ref{sec:bagofnotes})
and represent each one as a distribution over the <span class="math notranslate nohighlight">\(V=35\)</span> tonal pitch-classes.
That is, in the corpus used here with <span class="math notranslate nohighlight">\(D=2012\)</span> pieces, the tonal pitch-class distribution of a musical piece <span class="math notranslate nohighlight">\(x_d\)</span>
is given by the relative frequencies of the tonal pitch class in that piece, for <span class="math notranslate nohighlight">\(d\in \{1,\ldots,D\}\)</span>.
Each piece is thus described by a <span class="math notranslate nohighlight">\(V\)</span>-dimensional vector, <span class="math notranslate nohighlight">\(x_d \in \mathbb R^V, \forall d \in\{1,\ldots,D\}\)</span>,
containing positive real numbers that sum to 1.
In this chapter, we do not make any further assumptions about the process that generated
this distribution and will postpone these considerations until Chapter~ref{chap:tonal_profiles}.</p>
<p>In this view, pieces simply correspond to points in the <span class="math notranslate nohighlight">\(V - 1\)</span>-simplex</p>
<div class="math notranslate nohighlight">
\[\Delta^{V-1} =       \left\{ x_d \in \mathbb{R}^V
\,\middle\vert\, \sum_{i=1}^V x_{d,i} = 1;\; x_{d,i}\geq 0 \right\}.\]</div>
<p>In this space, those pieces with very different tonal pitch-class distributions will be very distant,
whereas pieces that have similar tonal pitch-class distributions will be closer to one another and form clusters
in the <span class="math notranslate nohighlight">\(V-1\)</span>-simplex.
It is important to note that the bag-of-notes representation relies on the assumption that the <span class="math notranslate nohighlight">\(V\)</span> dimensions are independent,
meaning that this model does not <em>a priori</em> assume any particular order between the tonal pitch-classes.</p>
<p>The average tonal pitch-class distribution of all pieces in the corpus is shown in Figure~ref{fig:pca_mean}.
Figure~ref{fig:tpc_mean_dist_periods} in the appendix shows this distribution separately
for each century from 1361 to 1943.
Although we know that one can in principle order all tonal pitch-classes on the line of fifths
(<a class="reference internal" href="#line-of-fifths"><span class="std std-numref">Fig. 10.2</span></a>), we do not incorporate this assumption into the model but
will show instead that it can be inferred from the data.</p>
<div class="section" id="distributions-of-tpcs">
<h3><span class="section-number">10.1.1. </span>Distributions of TPCs<a class="headerlink" href="#distributions-of-tpcs" title="Permalink to this headline">¶</a></h3>
<p>What are (discrete) distributions?</p>
<p>entropy</p>
<p><strong>Hypothesis: similar pieces have similar distributions</strong></p>
<p>operationalization: distances in vector space</p>
<p>Assumption (for coloring): tonal center is approximated by most frequent note</p>
<p>Taking tonal spaces into account: the line of fifths (dimensionality reduction, clustering, t-SNE, PCA)</p>
</div>
<div class="section" id="principle-component-analysis">
<h3><span class="section-number">10.1.2. </span>Principle Component Analysis<a class="headerlink" href="#principle-component-analysis" title="Permalink to this headline">¶</a></h3>
<p>Since the dimensionality of <span class="math notranslate nohighlight">\(\Delta^{V-1}\)</span> is
<span class="math notranslate nohighlight">\(|\{\text{C}, \text{D}, \text{E}, \text{F}, \text{G}, \text{A}, \text{B}\}| \cdot |\{\flat\flat, \flat, \natural, \sharp, \sharp\sharp\}| = 35\)</span>, it is impossible to visualize
this space and pieces in it to see whether their arrangement contains any meaningful information.
We address this problem by using a method for <em>dimensionality reduction</em>
called <em>Principal Component Analysis</em> (PCA) <span class="bibtex" id="id12">[Bishop2006]</span>
that projects the data into a lower-dimensional space while at the same time maintaining
as many characteristic properties of the original space as possible.
PCA thus can aid to achieve a better understanding of
the global structure of the space. <a class="footnote-reference brackets" href="#f1" id="id13">1</a></p>
<p>PCA considers the data to be represented as a matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}X = \left[\begin{array}{c}
               x_1^\top \\
               \vdots \\
               x_D^\top \\
            \end{array}
         \right] \in [0,1]^{D \times V},\;   x_d \in \Delta^{V-1},\end{split}\]</div>
<p>where the rows are given by the <span class="math notranslate nohighlight">\(D\)</span> data points, the pieces in the corpus,
and the columns are given by the <span class="math notranslate nohighlight">\(V\)</span> features, the number of distinct tonal pitch-classes in the vocabulary.
All entries in <span class="math notranslate nohighlight">\(X\)</span> range between 0 and 1 and all rows of <span class="math notranslate nohighlight">\(X\)</span> sum to 1 because the pieces are represented
as distributions.
PCA determines the <span class="math notranslate nohighlight">\(M\leq V\)</span> largest directions and magnitudes of the variance in the data in <span class="math notranslate nohighlight">\(X\)</span> by first
calculating the <em>covariance matrix</em></p>
<div class="math notranslate nohighlight">
\[K_X = \mathrm{cov}[X,X] = \mathrm{E}[(X-\bar{x})(X-\bar{x})^\top] \in\mathbb R^{D\times D},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathrm{E}\)</span> denotes the expected value and <span class="math notranslate nohighlight">\(\bar{x}\in[0,1]^V\)</span> is the mean of the columns of <span class="math notranslate nohighlight">\(X\)</span>.
The main directions of the variance in the data and their magnitude is given by the eigenvectors <span class="math notranslate nohighlight">\(w_i\)</span>
and eigenvalues <span class="math notranslate nohighlight">\(\lambda_i\)</span> of <span class="math notranslate nohighlight">\(K_X\)</span> which can be calculated by solving</p>
<div class="math notranslate nohighlight">
\[K \cdot w_i = \lambda \cdot w_i.\]</div>
<p>The projection into the lower-dimensional space is then achieved by selecting the <span class="math notranslate nohighlight">\(M\)</span> largest eigenvalues
and their corresponding eigenvectors and transform the data to <span class="math notranslate nohighlight">\(X^\prime\)</span>, the dimensionality reduction of <span class="math notranslate nohighlight">\(X\)</span> by</p>
<div class="math notranslate nohighlight">
\[X^\prime = X \cdot \left[ w_1,        \ldots, w_M \right]\in \mathbb R^{D\times M}\]</div>
<p>The sum of all eigenvalues <span class="math notranslate nohighlight">\(\lambda_i\)</span> is the total amount of variance in the data and the variance explained
by each principal component is given by <span class="math notranslate nohighlight">\(\lambda_i / \sum_j \lambda_j\)</span>.</p>
<p>In the present context, <span class="math notranslate nohighlight">\(X\)</span> was transformed to have zero mean before applying PCA
but that the variance was not standardized to 1.
This was done because the features all are on the same scale and because the
differences in the variance between the respective tonal pitch-classes is of particular
interest here.</p>
</div>
</div>
<div class="section" id="historical-development">
<h2><span class="section-number">10.2. </span>Historical Development<a class="headerlink" href="#historical-development" title="Permalink to this headline">¶</a></h2>
<p>historical expansion on line of fifths,</p>
<div class="section" id="lowess">
<h3><span class="section-number">10.2.1. </span>LOWESS<a class="headerlink" href="#lowess" title="Permalink to this headline">¶</a></h3>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id13">1</a></span></dt>
<dd><p>While PCA is one of the most commonly used methods for dimensionality reduction, there are many others
(sometimes relying on particular assumptions about the distribution of the data).
In a qualitative comparison, <em>Locally Linear Embedding</em> <span class="bibtex" id="id14">[Roweis2000]</span> achieved a similar picture,
whereas <em>t-distributed Stochastic Neighbor Embedding</em> (t-SNE) <span class="bibtex" id="id15">[VanDerMaaten2008]</span>
that does emphasize the local over the global structure of the data did not.
We opted here for PCA because it preserves most
of the global structure and the interpretation of the results is straight-forward.</p>
</dd>
</dl>
</div>
</div>
</div>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="choro.html"
       title="previous chapter">← <span class="section-number">9. </span>Harmony and Form in Brazilian Choro</a>
  </li>
  <li class="next">
    <a href="mali_percussion.html"
       title="next chapter"><span class="section-number">11. </span>Malian Percussion Music →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2020, Fabian C. Moss.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.1.2 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a>.
</div>
            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>